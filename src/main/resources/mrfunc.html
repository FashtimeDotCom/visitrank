<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
</head>
<body class="yui3-skin-sam">

	<div id="testLogger"></div>

	<script
		src="http://yuimin.fh.gov.cn/min/?&5566&f=/3.13.0/build/yui/yui-min.js"
		type="text/javascript"></script>

	<script type="text/javascript">
        var fixtures = [
                {
                    "url" : "http://www.fh.gov.cn/szzc/sz_zfld/ld_cza/",
                    "silent" : "true",
                    "ts" : 1396586730192,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "Accept" : "*/*",
                        "Accept-Language" : "zh-cn",
                        "User-Agent" : "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)",
                        "X-Forwarded-For" : "60.174.213.188, 60.174.213.188, 127.0.0.1",
                        "X-Varnish" : "374563386",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                },
                {
                    "url" : "http://www.fh.gov.cn/zcfg/",
                    "silent" : "true",
                    "ts" : 1396586737384,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "User-Agent" : "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1",
                        "Accept" : "*/*",
                        "Accept-Language" : "zh-CN,zh;q=0.8",
                        "Accept-Charset" : "GBK,utf-8;q=0.7,*;q=0.3",
                        "Cookie" : "jzmm_uid=dongp; jzmm_uid_ch=",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-For" : "10.74.111.254, 10.74.111.254, 127.0.0.1",
                        "X-Varnish" : "374563391",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                },
                {
                    "url" : "http://www.fh.gov.cn/zcfg/zhjj/swjj/",
                    "silent" : "true",
                    "ts" : 1396586739084,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "User-Agent" : "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1",
                        "Accept" : "*/*",
                        "Accept-Language" : "zh-CN,zh;q=0.8",
                        "Accept-Charset" : "GBK,utf-8;q=0.7,*;q=0.3",
                        "Cookie" : "jzmm_uid=dongp; jzmm_uid_ch=",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-For" : "10.74.111.254, 10.74.111.254, 127.0.0.1",
                        "X-Varnish" : "374563393",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                },
                {
                    "url" : "http://www.fh.gov.cn/zcfg/shsy3/",
                    "silent" : "true",
                    "ts" : 1396586766112,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "User-Agent" : "Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1",
                        "Accept" : "*/*",
                        "Accept-Language" : "zh-CN,zh;q=0.8",
                        "Accept-Charset" : "GBK,utf-8;q=0.7,*;q=0.3",
                        "Cookie" : "jzmm_uid=dongp; jzmm_uid_ch=",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-For" : "10.74.111.254, 10.74.111.254, 127.0.0.1",
                        "X-Varnish" : "374563404",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                },
                {
                    "url" : "http://www.fhic168.com/info.ftl?article=108218&ms=107852",
                    "siteid" : "08697083-94e3-45fa-bfc2-daa78ebf7fa3",
                    "domid" : "site-counter",
                    "ts" : 1396586880404,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "Accept" : "*/*",
                        "Accept-Language" : "zh-cn",
                        "User-Agent" : "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; GTB7.0)",
                        "X-Forwarded-For" : "115.217.136.140, 115.217.136.140, 127.0.0.1",
                        "X-Varnish" : "374563440",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                },
                {
                    "url" : "http://fh.ningbo.gov.cn/zwgk/spxw/",
                    "silent" : "true",
                    "ts" : 1396586979303,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "Accept" : "*/*",
                        "Accept-Language" : "zh-cn",
                        "User-Agent" : "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)",
                        "X-Forwarded-For" : "222.64.219.229, 222.64.219.229, 127.0.0.1",
                        "X-Varnish" : "374563489",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                },
                {
                    "url" : "http://www.fh.gov.cn/zwgk/zfcg/cgzb/index_28.html",
                    "silent" : "true",
                    "ts" : 1396587024970,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "Authorization" : "Basic YWRtaW46eG5qYzEyMzQ=",
                        "Accept-Language" : "zh-cn,en-us;q=0.7,en;q=0.3",
                        "Accept" : "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
                        "User-Agent" : "Mozilla/5.0 (Windows; U; Windows NT 6.1; zh-CN; rv:1.9.2.4) Gecko/20100611 Firefox/3.6.4",
                        "Accept-Charset" : "GBK,utf-8;q=0.7,*;q=0.3",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-For" : "115.217.253.54, 115.217.253.54, 127.0.0.1",
                        "X-Varnish" : "374563514",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                },
                {
                    "url" : "http://www.fh.gov.cn/zwgk/zfjg/szfgzbm/201304/t20130420_96414.html",
                    "silent" : "true",
                    "ts" : 1396587101115,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "Accept" : "*/*",
                        "Accept-Language" : "zh-cn",
                        "User-Agent" : "Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; LBBROWSER)",
                        "X-Forwarded-For" : "115.217.250.168, 115.217.250.168, 127.0.0.1",
                        "X-Varnish" : "374563552",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                },
                {
                    "url" : "http://www.fh.gov.cn/zwgk/tpxw/201402/t20140211_118146.html",
                    "silent" : "true",
                    "ts" : 1396587223375,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "User-Agent" : "Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1",
                        "Accept" : "*/*",
                        "Accept-Language" : "zh-CN,zh;q=0.8",
                        "Accept-Charset" : "GBK,utf-8;q=0.7,*;q=0.3",
                        "X-Forwarded-For" : "125.115.141.54, 125.115.141.54, 127.0.0.1",
                        "X-Varnish" : "374563623",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                },
                {
                    "url" : "http://www.fhsafety.gov.cn/",
                    "domid" : "wholesite_count",
                    "ts" : 1396587259785,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "User-Agent" : "Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1",
                        "Accept" : "*/*",
                        "Accept-Language" : "zh-CN,zh;q=0.8",
                        "Accept-Charset" : "GBK,utf-8;q=0.7,*;q=0.3",
                        "X-Forwarded-For" : "61.171.246.132, 61.171.246.132, 127.0.0.1",
                        "X-Varnish" : "374563646",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                },
                {
                    "url" : "http://www.fh.gov.cn/wshd/cjwtjd/shbz/201402/t20140219_118620.html",
                    "silent" : "true",
                    "ts" : 1396587345037,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "User-Agent" : "Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1",
                        "Accept" : "*/*",
                        "Accept-Language" : "zh-CN,zh;q=0.8",
                        "Accept-Charset" : "GBK,utf-8;q=0.7,*;q=0.3",
                        "X-Forwarded-For" : "36.251.188.233, 36.251.188.233, 127.0.0.1",
                        "X-Varnish" : "374563725",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                },
                {
                    "url" : "http://www.fh.gov.cn/wshd/cjwtjd/jypx/201307/t20130702_103247.html",
                    "silent" : "true",
                    "ts" : 1396587468210,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "User-Agent" : "Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1",
                        "Accept" : "*/*",
                        "Accept-Language" : "zh-CN,zh;q=0.8",
                        "Accept-Charset" : "GBK,utf-8;q=0.7,*;q=0.3",
                        "X-Forwarded-For" : "36.251.188.233, 36.251.188.233, 127.0.0.1",
                        "X-Varnish" : "374563763",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                },
                {
                    "url" : "http://www.fh.gov.cn/zwgk/zfcg/cgzb/index_26.html",
                    "silent" : "true",
                    "ts" : 1396587494630,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "Authorization" : "Basic YWRtaW46eG5qYzEyMzQ=",
                        "Accept-Language" : "zh-cn,en-us;q=0.7,en;q=0.3",
                        "Accept" : "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
                        "User-Agent" : "Mozilla/5.0 (Windows; U; Windows NT 6.1; zh-CN; rv:1.9.2.4) Gecko/20100611 Firefox/3.6.4",
                        "Accept-Charset" : "GBK,utf-8;q=0.7,*;q=0.3",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-For" : "115.217.253.54, 115.217.253.54, 127.0.0.1",
                        "X-Varnish" : "374563770",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                },
                {
                    "url" : "http://www.fhsafety.gov.cn/",
                    "domid" : "wholesite_count",
                    "ts" : 1396587503207,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "Accept" : "*/*",
                        "User-Agent" : "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.154 Safari/537.36",
                        "Accept-Language" : "zh-CN,zh;q=0.8,en;q=0.6,ja;q=0.4,zh-TW;q=0.2",
                        "Cookie" : "jzmm_uid=szfadmin; jzmm_uid_ch=; LtpaToken=AAECAzUzM0NDNThFNTMzRDUyMkVDTj1zemZhZG1pbi9PVT1zemYvTz1mZW5naHVhS8i/tApkmnsueplNf8K8HXRljNk=",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-For" : "10.74.111.254, 10.74.111.254, 127.0.0.1",
                        "X-Varnish" : "374563778",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                },
                {
                    "url" : "http://www.fhsafety.gov.cn/article.ftl?article=112167&ms=84224",
                    "domid" : "wholesite_count",
                    "ts" : 1396587508489,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "Accept" : "*/*",
                        "User-Agent" : "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.154 Safari/537.36",
                        "Accept-Language" : "zh-CN,zh;q=0.8,en;q=0.6,ja;q=0.4,zh-TW;q=0.2",
                        "Cookie" : "jzmm_uid=szfadmin; jzmm_uid_ch=; LtpaToken=AAECAzUzM0NDNThFNTMzRDUyMkVDTj1zemZhZG1pbi9PVT1zemYvTz1mZW5naHVhS8i/tApkmnsueplNf8K8HXRljNk=",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-For" : "10.74.111.254, 10.74.111.254, 127.0.0.1",
                        "X-Varnish" : "374563804",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                },
                {
                    "url" : "http://www.fhsafety.gov.cn/",
                    "domid" : "wholesite_count",
                    "ts" : 1396587518721,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "Accept" : "*/*",
                        "User-Agent" : "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.154 Safari/537.36",
                        "Accept-Language" : "zh-CN,zh;q=0.8,en;q=0.6,ja;q=0.4,zh-TW;q=0.2",
                        "Cookie" : "jzmm_uid=szfadmin; jzmm_uid_ch=; LtpaToken=AAECAzUzM0NDNThFNTMzRDUyMkVDTj1zemZhZG1pbi9PVT1zemYvTz1mZW5naHVhS8i/tApkmnsueplNf8K8HXRljNk=",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-For" : "10.74.111.254, 10.74.111.254, 127.0.0.1",
                        "X-Varnish" : "374563811",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                },
                {
                    "url" : "http://www.fhsafety.gov.cn/article.ftl?article=111891&ms=84224&section=84153",
                    "domid" : "wholesite_count",
                    "ts" : 1396587525833,
                    "headers" : {
                        "Host" : "vr.fh.gov.cn:8333",
                        "Accept" : "*/*",
                        "User-Agent" : "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.154 Safari/537.36",
                        "Accept-Language" : "zh-CN,zh;q=0.8,en;q=0.6,ja;q=0.4,zh-TW;q=0.2",
                        "Cookie" : "",
                        "Accept-Encoding" : "gzip",
                        "X-Forwarded-For" : "10.74.111.254, 10.74.111.254, 127.0.0.1",
                        "X-Varnish" : "374563815",
                        "X-Forwarded-Host" : "vr.fh.gov.cn",
                        "X-Forwarded-Server" : "vr.fh.gov.cn",
                        "Connection" : "Keep-Alive",
                        "ip" : "127.0.0.1"
                    }
                } ];
        function mapFunction() {
            var key = this.url,
            	value = {
                url : this.url,
                count : 1
            };
            emit(key, value);
        }

        function reduceFunction(key, values) {
            var reducedObject = {
                url : key,
                count : 0
            };

            values.forEach(function(value) {
                reducedObject.count += value.count;
            });
            return reducedObject;
        }
    </script>

	<script type="text/javascript">
        function extractHost(url) {
            var hn, i = url.indexOf("//");
            if (i == -1) {
                return null;
            }
            hn = url.substring(i + 2);

            var slash = hn.indexOf('/');
            var qmark = hn.indexOf('?');

            if (slash == -1) {
                if (qmark == -1) {
                    return hn;
                } else {
                    return hn.substring(0, qmark);
                }
            } else {
                if (qmark == -1) {
                    return hn.substring(0, slash);
                } else {
                    var j = slash > qmark ? qmark : slash;
                    return hn.substring(0, j);
                }
            }
        }

        function t() {
            var a = 1;
        }
    </script>
	<script>
        // Create a new YUI instance and populate it with the required modules.
        //http://jscompress.com/
        YUI()
                .use(
                        'node',
                        'test-console',
                        'test',
                        function(Y) {

                            function sortArray(array) {
                                if (array instanceof Array) {
                                    array.sort();
                                } else {
                                    throw new TypeError("Expected an array");
                                }
                            }

                            var testCase = new Y.Test.Case(
                                    {

                                        name : "TestCase Name",

                                        //---------------------------------------------
                                        // Special instructions
                                        //---------------------------------------------

                                        _should : {
                                            error : {
                                                testSortArray : new TypeError(
                                                        "Expected an array")
                                            }
                                        },

                                        //---------------------------------------------
                                        // Tests
                                        //---------------------------------------------

                                        testSortArray : function() {
                                            sortArray(12); //this should throw an error
                                        },

                                        testHostExtra : function() {
                                            Y.Assert
                                                    .areEqual(
                                                            "www.m3958.com",
                                                            extractHost("http://www.m3958.com"));
                                            Y.Assert
                                                    .areEqual(
                                                            "www.m3958.com",
                                                            extractHost("https://www.m3958.com?abc=xxx"));
                                            Y.Assert
                                                    .areEqual(
                                                            "www.m3958.com",
                                                            extractHost("https://www.m3958.com/abc"));
                                            Y.Assert
                                                    .areEqual(
                                                            "www.m3958.com",
                                                            extractHost("https://www.m3958.com/abc?u=x"));
                                            Y.Assert
                                                    .areEqual(
                                                            "www.m3958.com",
                                                            extractHost("https://www.m3958.com?abc=uuu/6677"));
                                        }

                                    });

                            (new Y.Test.Console({
                                newestOnTop : false,
                                filters : {
                                    pass : true,
                                    fail : true
                                }
                            })).render('#testLogger');

                            Y.Test.Runner.add(testCase);
                            Y.Test.Runner.run();
                        });
        
        //结果集{ "_id" : "http://sb.m3958.com?article=0", "value" : { "url" : "http://sb.m3958.com?article=0", "count" : 2 } }
    </script>
</body>
</html>